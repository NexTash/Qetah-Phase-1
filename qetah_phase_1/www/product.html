{% extends "templates/primary.html" %}
{% block content %}

<div class="content-area" :class="{'shifted-content': isStatic}">
    <div class="container section-products">
        <div class="filters">

            <div class="category-filters">
                <h5 id="category_title">Category</h5>
                <hr>
                <label class="check check-dark mt-2">
                    <input type="checkbox" name="category" value="Men's Collection" /><span id="category_mens_l"></span>
                </label>
                <label class="check check-dark">
                    <input type="checkbox" name="category" value="Women's Collection" /><span
                        id="category_womens_l"></span>

                </label>
                <label class="check check-dark">
                    <input type="checkbox" name="category" value="Services" /> <span id="category_services_l"></span>
                </label>
                <h5 id="price_range_title">Price Range</h5>
                <hr>
                <div class="range-slider">
                    <span class="rangeValues"></span>
                    <input value="0" min="0" max="50000" step="500" id="price-range-min" name="min_price" type="range">
                    <input value="50000" min="0" max="50000" step="500" id="price-range-max" name="max_price"
                        type="range">
                </div>
                <h5 class="mt-3" id="by_rating_title">By Rating</h5>
                <hr>
                <div class="field-rating">
                    <input type="radio" id="star5" name="rating" value="5">
                    <label for="star5" title="5 stars"></label>
                    <input type="radio" id="star4" name="rating" value="4">
                    <label for="star4" title="4 stars"></label>
                    <input type="radio" id="star3" name="rating" value="3">
                    <label for="star3" title="3 stars"></label>
                    <input type="radio" id="star2" name="rating" value="2">
                    <label for="star2" title="2 stars"></label>
                    <input type="radio" id="star1" name="rating" value="1">
                    <label for="star1" title="1 star"></label>
                </div>
                <h5 id="discounts_title_h">Discounts</h5>
                <hr>
                <label class="check check-dark mt-2">
                    <input type="checkbox" name="discount" value="35" />
                    <h6 id="discount_35_l">Sale 35% OFF</h6>
                </label>
                <label class="check check-dark">
                    <input type="checkbox" name="discount" value="50" />
                    <h6 id="discount_50_l"> Sale 50% OFF</h6>
                </label>
                <label class="check check-dark">
                    <input type="checkbox" name="discount" value="75" />
                    <h6 id="discount_75_l">Sale 75% OFF</h6>
                </label>
                <button type="button" class="btn btn-secondary" onclick="applyFilters()"
                    id="apply_button">Apply</button>
            </div>
        </div>
        <div class="filtered-cards">
            <div class="container model-container" x-data="{ isOpen: false }">
                <button class="btn btn-light btn-icon btn-model" x-on:click="isOpen = true"
                    id="filter_title">Filters</button>
                <div class="modal active" x-show="isOpen" x-transition>
                    <div class="modal-dialog">
                        <div class="modal-content" @click.away="isOpen = false">
                            <div class="modal-head">
                                <h3 class="modal-title" id="filter_title_m">Filter</h3>
                                <button x-on:click="isOpen = false"
                                    class="btn btn-danger btn-icon btn-circle btn-circle-sm bx bx-x"></button>
                            </div>

                            <div class="modal-body">
                                <div class="filters-model-body">
                                    <div class="category-filters">
                                        <h5 id="category_title_m">Category</h5>
                                        <hr>
                                        <label class="check check-dark mt-2"><input type="checkbox"
                                                value="Men's Collection" name="category" />
                                            <span id="category_mens_m"></span>
                                        </label>

                                        <label class="check check-dark"><input type="checkbox"
                                                value="Women's Collection" name="category" />
                                            <span id="category_womens_m"></span>
                                        </label>
                                        <label class="check check-dark"><input type="checkbox" value="Services"
                                                name="category" />
                                            <span id="category_services_m"></span>
                                        </label>
                                        <h5 id="price_range_title_m">Price Range</h5>
                                        <hr>
                                        <div class="range-slider"></div>
                                        <span class="rangeValues"></span>
                                        <input value="1000" min="1000" max="50000" step="500" id="price-range-min"
                                            name="min_price" type="range">
                                        <input value="50000" min="1000" max="50000" step="500" id="price-range-max"
                                            name="max_price" type="range">
                                    </div>

                                    <h5 class="mt-3" id="by_rating_title_m">By Rating</h5>
                                    <hr>
                                    <div class="field-rating">
                                        <input type="radio" id="star5" name="rating" value="5">
                                        <label for="star5" title="5 stars"></label>
                                        <input type="radio" id="star4" name="rating" value="4">
                                        <label for="star4" title="4 stars"></label>
                                        <input type="radio" id="star3" name="rating" value="3">
                                        <label for="star3" title="3 stars"></label>
                                        <input type="radio" id="star2" name="rating" value="2">
                                        <label for="star2" title="2 stars"></label>
                                        <input type="radio" id="star1" name="rating" value="1">
                                        <label for="star1" title="1 star"></label>
                                    </div>
                                    <h5 id="discounts_title_m">Discounts</h5>
                                    <hr>
                                    <label class="check check-dark mt-2">
                                        <input type="checkbox" name="discount" value="35" /> <span
                                            id="discount_35_m"></span>
                                    </label>
                                    <label class="check check-dark">
                                        <input type="checkbox" name="discount" value="50" /> <span
                                            id="discount_50_m"></span>
                                    </label>
                                    <label class="check check-dark">
                                        <input type="checkbox" name="discount" value="75" /><span
                                            id="discount_75_m"></span>
                                    </label>

                                </div>
                            </div>
                            <div class="modal-foot">
                                <button class="btn" x-on:click="isOpen = false" id="cancel_button_m">Cancel</button>
                                <button class="btn btn-primary" onclick="applyFilters()"
                                    id="apply_button_m">Apply</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <form class="field field-inline" onsubmit="return false;">
                <input type="text" class="field-text" id="search-query" placeholder="" name="q">
                <button type="button" class="field-icon bx bx-search" onclick="applyFilters()"></button>
            </form>
            <div class="cards">
                <div class="boxed">
                    <!-- Alpine.js Data for Tab Control -->
                    <div class="tabs" x-data="{ OpenTab: 1 }">
                        <!-- Tabs -->
                        <div class="tabs-items">
                            <!-- Tab Buttons -->
                            <button id="tab_all" class="tab-item" :class="OpenTab == 1 ? 'active' : 'inactive'"
                                @click="OpenTab = 1">All</button>
                            <button id="tab_unstitched" class="tab-item" :class="OpenTab == 2 ? 'active' : 'inactive'"
                                @click="OpenTab = 2">Un-stitched</button>
                            <button id="tab_readymade" class="tab-item" :class="OpenTab == 3 ? 'active' : 'inactive'"
                                @click="OpenTab = 3">ReadyMade</button>
                            <button id="tab_accessories" class="tab-item" :class="OpenTab == 4 ? 'active' : 'inactive'"
                                @click="OpenTab = 4">Accessories</button>
                            <button id="tab_perfumes" class="tab-item" :class="OpenTab == 5 ? 'active' : 'inactive'"
                                @click="OpenTab = 5">Perfumes</button>
                            <button id="tab_cutting_stitching" class="tab-item"
                                :class="OpenTab == 6 ? 'active' : 'inactive'" @click="OpenTab = 6">Cutting &
                                Stitching</button>

                        </div>

                        <!-- Tab Panes -->
                        <div class="tab-panes">

                            <!-- All Products Tab -->
                            <div x-show="OpenTab == 1" class="tab-pane">
                                <div class="row">
                                    {% for product in products %}
                                    <div class="products">
                                        <div class="badge badge-primary badge-pill" data-field="en">{{ product.title }}
                                        </div>
                                        <div class="badge badge-primary badge-pill" data-field="ar">{{
                                            product.title_arabic }}
                                        </div>
                                        {% if product.variations["qty"]|int > 0 %}
                                        <!-- Available Badge when qty is greater than 0 -->
                                        <div class="badge badge-primary badge-pill available"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Available</div>
                                        {% else %}
                                        <!-- Sold Out Badge when qty is 0 or less -->
                                        <div class="badge badge-primary badge-pill soldout"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Sold Out</div>
                                        {% endif %}


                                        <div class="card product-card">
                                            <a
                                                href="/product-detail?product_name={{product.name}}&&varient_name={{product.variations['name']}}">
                                                <div class="card-head">
                                                    <img class="card-image" src="{{ product.featured_image }}"
                                                        alt="Product Image">
                                                </div>

                                                <div class="card-body">
                                                    <div class="variation">
                                                        <div class="card-unique-name" style="display: none;">{{
                                                            product.variations['name'] }}</div>
                                                        <div class="card-title" data-field="en">{{
                                                            product.variations["title"]
                                                            }}</div>
                                                        <div class="card-title" data-field="ar">{{
                                                            product.variations["title_arabic"]
                                                            }}
                                                        </div>
                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="en">{{
                                                            product.variations["desc"]
                                                            }}</div>
                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="ar">{{
                                                            product.variations["desc_arabic"]
                                                            }}</div>
                                                        <div class="card-subtitle"><del>{{
                                                                product.variations["discount"]}}</del>
                                                        </div>
                                                        <div class="card-title card-price">$
                                                            {{
                                                            product.variations["price"]
                                                            }}</div>
                                                    </div>

                                                    <div class="card-rating remaining">
                                                        <i class="bx bxs-star"></i>
                                                        <span>{{product.variations["rating"]}}</span>
                                                        ({{product.variations["qty"]}}) Remaining
                                                    </div>
                                                </div>
                                            </a>
                                            <div class="card-foot">
                                                <button class="btn btn-light btn-icon btn-pill btn-cart"><i
                                                        class="bx bx-cart icon-pre buy_now_button"
                                                        id="buy_now_button"></i>
                                                </button>
                                                <!-- <button class="btn btn-light btn-icon btn-circle bx bx-heart btn-heart" style="display: none;"></button> -->
                                            </div>

                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>

                            <!-- Un-stitched Products Tab -->
                            <div x-show="OpenTab == 2" class="tab-pane">
                                <div class="row">
                                    {% for product in products if product.category ==
                                    'Un-stiched' %}
                                    <div class="products">
                                        <div class="badge badge-primary badge-pill" data-field="en">{{ product.title }}
                                        </div>
                                        <div class="badge badge-primary badge-pill" data-field="ar">{{
                                            product.title_arabic }}
                                        </div>
                                        {% if product.variations["qty"]|int > 0 %}
                                        <!-- Available Badge when qty is greater than 0 -->
                                        <div class="badge badge-primary badge-pill available"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Available</div>
                                        {% else %}
                                        <!-- Sold Out Badge when qty is 0 or less -->
                                        <div class="badge badge-primary badge-pill soldout"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Sold Out</div>
                                        {% endif %}
                                        <div class="card product-card">
                                            <a href="/product-detail?id={{product.name}}">
                                                <div class="card-head">
                                                    <img class="card-image" src="{{ product.featured_image }}"
                                                        alt="Product Image">
                                                </div>

                                                <div class="card-body">

                                                    <div class="variation">
                                                        <div class="card-title" data-field="en">{{
                                                            product.variations["title"]
                                                            }}</div>
                                                        <div class="card-title" data-field="ar">{{
                                                            product.variations["title_arabic"]
                                                            }}
                                                        </div>

                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="en">{{
                                                            product.variations["desc"]
                                                            }}</div>
                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="ar">{{
                                                            product.variations["desc_arabic"]
                                                            }}</div>
                                                        <div class="card-subtitle"><del>{{
                                                                product.variations["discount"]}}</del>
                                                        </div>
                                                        <div class="card-title card-price">$
                                                            {{
                                                            product.variations["price"]
                                                            }}</div>
                                                    </div>

                                                    <div class="card-rating remaining">
                                                        <i class="bx bxs-star"></i>
                                                        <span>{{product.variations["rating"]}}</span>
                                                        ({{product.variations["qty"]}}) Remaining
                                                    </div>
                                                </div>
                                            </a>
                                            <div class="card-foot">
                                                <button class="btn btn-light btn-icon btn-pill btn-cart"><i
                                                        class="bx bx-cart icon-pre buy_now_button"
                                                        id="buy_now_button"></i>
                                                </button>
                                                <!-- <button class="btn btn-light btn-icon btn-circle bx bx-heart btn-heart" style="display:none"></button> -->
                                            </div>

                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>

                            <!-- ReadyMade Products Tab -->
                            <div x-show="OpenTab == 3" class="tab-pane">
                                <div class="row">
                                    {% for product in products if product.category ==
                                    'ReadyMade' %}
                                    <div class="products">
                                        <div class="badge badge-primary badge-pill" data-field="en">{{ product.title }}
                                        </div>
                                        <div class="badge badge-primary badge-pill" data-field="ar">{{
                                            product.title_arabic }}
                                        </div>
                                        {% if product.variations["qty"]|int > 0 %}
                                        <!-- Available Badge when qty is greater than 0 -->
                                        <div class="badge badge-primary badge-pill available"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Available</div>
                                        {% else %}
                                        <!-- Sold Out Badge when qty is 0 or less -->
                                        <div class="badge badge-primary badge-pill soldout"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Sold Out</div>
                                        {% endif %}
                                        <div class="card product-card">
                                            <a href="/product-detail?id={{product.name}}">
                                                <div class="card-head">
                                                    <img class="card-image" src="{{ product.featured_image }}"
                                                        alt="Product Image">
                                                </div>

                                                <div class="card-body">

                                                    <div class="variation">
                                                        <div class="card-title" data-field="en">{{
                                                            product.variations["title"]
                                                            }}</div>
                                                        <div class="card-title" data-field="ar">{{
                                                            product.variations["title_arabic"]
                                                            }}
                                                        </div>

                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="en">{{
                                                            product.variations["desc"]
                                                            }}</div>
                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="ar">{{
                                                            product.variations["desc_arabic"]
                                                            }}</div>
                                                        <div class="card-subtitle"><del>{{
                                                                product.variations["discount"]}}</del>
                                                        </div>
                                                        <div class="card-title card-price">$
                                                            {{
                                                            product.variations["price"]
                                                            }}</div>
                                                    </div>

                                                    <div class="card-rating remaining">
                                                        <i class="bx bxs-star"></i>
                                                        <span>{{product.variations["rating"]}}</span>
                                                        ({{product.variations["qty"]}}) Remaining
                                                    </div>
                                                </div>
                                            </a>
                                            <div class="card-foot">
                                                <button class="btn btn-light btn-icon btn-pill btn-cart"><i
                                                        class="bx bx-cart icon-pre buy_now_button"
                                                        id="buy_now_button_b"></i>
                                                </button>
                                                <!-- <button class="btn btn-light btn-icon btn-circle bx bx-heart btn-heart" style="display:none"></button> -->
                                            </div>

                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>

                            <!-- Accessories Products Tab -->
                            <div x-show="OpenTab == 4" class="tab-pane">
                                <div class="row">
                                    {% for product in products if product.category ==
                                    'Accessories' %}
                                    <div class="products">
                                        <div class="badge badge-primary badge-pill" data-field="en">{{ product.title }}
                                        </div>
                                        <div class="badge badge-primary badge-pill" data-field="ar">{{
                                            product.title_arabic }}
                                        </div>
                                        {% if product.variations["qty"]|int > 0 %}
                                        <!-- Available Badge when qty is greater than 0 -->
                                        <div class="badge badge-primary badge-pill available"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Available</div>
                                        {% else %}
                                        <!-- Sold Out Badge when qty is 0 or less -->
                                        <div class="badge badge-primary badge-pill soldout"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Sold Out</div>
                                        {% endif %}
                                        <div class="card product-card">
                                            <a href="/product-detail?id={{product.name}}">
                                                <div class="card-head">
                                                    <img class="card-image" src="{{ product.featured_image }}"
                                                        alt="Product Image">
                                                </div>
                                                <div class="card-body">

                                                    <div class="variation">
                                                        <div class="card-title" data-field="en">{{
                                                            product.variations["title"]
                                                            }}</div>
                                                        <div class="card-title" data-field="ar">{{
                                                            product.variations["title_arabic"]
                                                            }}
                                                        </div>

                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="en">{{
                                                            product.variations["desc"]
                                                            }}</div>
                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="ar">{{
                                                            product.variations["desc_arabic"]
                                                            }}</div>
                                                        <div class="card-subtitle"><del>{{
                                                                product.variations["discount"]}}</del>
                                                        </div>
                                                        <div class="card-title card-price">$
                                                            {{
                                                            product.variations["price"]
                                                            }}</div>
                                                    </div>

                                                    <div class="card-rating remaining">
                                                        <i class="bx bxs-star"></i>
                                                        <span>{{product.variations["rating"]}}</span>
                                                        ({{product.variations["qty"]}}) Remaining
                                                    </div>
                                                </div>
                                            </a>
                                            <div class="card-foot">
                                                <button class="btn btn-light btn-icon btn-pill btn-cart"><i
                                                        class="bx bx-cart icon-pre buy_now_button"
                                                        id="buy_now_button_c"></i>
                                                </button>
                                                <!-- <button class="btn btn-light btn-icon btn-circle bx bx-heart btn-heart" style="display:none"></button> -->
                                            </div>

                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>

                            <!-- Perfumes Products Tab -->
                            <div x-show="OpenTab == 5" class="tab-pane">
                                <div class="row">
                                    {% for product in products if product.category ==
                                    'Perfumes' %}
                                    <div class="products">
                                        <div class="badge badge-primary badge-pill" data-field="en">{{ product.title }}
                                        </div>
                                        <div class="badge badge-primary badge-pill" data-field="ar">{{
                                            product.title_arabic }}
                                        </div>
                                        {% if product.variations["qty"]|int > 0 %}
                                        <!-- Available Badge when qty is greater than 0 -->
                                        <div class="badge badge-primary badge-pill available"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Available</div>
                                        {% else %}
                                        <!-- Sold Out Badge when qty is 0 or less -->
                                        <div class="badge badge-primary badge-pill soldout"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Sold Out</div>
                                        {% endif %}
                                        <div class="card product-card">
                                            <a href="/product-detail?id={{product.name}}">
                                                <div class="card-head">
                                                    <img class="card-image" src="{{ product.featured_image }}"
                                                        alt="Product Image">
                                                </div>
                                                <div class="card-body">

                                                    <div class="variation">
                                                        <div class="card-title" data-field="en">{{
                                                            product.variations["title"]
                                                            }}</div>
                                                        <div class="card-title" data-field="ar">{{
                                                            product.variations["title_arabic"]
                                                            }}
                                                        </div>

                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="en">{{
                                                            product.variations["desc"]
                                                            }}</div>
                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="ar">{{
                                                            product.variations["desc_arabic"]
                                                            }}</div>
                                                        <div class="card-subtitle"><del>{{
                                                                product.variations["discount"]}}</del>
                                                        </div>
                                                        <div class="card-title card-price">$
                                                            {{
                                                            product.variations["price"]
                                                            }}</div>
                                                    </div>

                                                    <div class="card-rating remaining">
                                                        <i class="bx bxs-star"></i>
                                                        <span>{{product.variations["rating"]}}</span>
                                                        ({{product.variations["qty"]}}) Remaining
                                                    </div>
                                                </div>
                                            </a>
                                            <div class="card-foot">
                                                <button class="btn btn-light btn-icon btn-pill btn-cart"><i
                                                        class="bx bx-cart icon-pre buy_now_button"
                                                        id="buy_now_button_d"></i>
                                                </button>
                                                <!-- <button class="btn btn-light btn-icon btn-circle bx bx-heart btn-heart" style="display:none"></button> -->
                                            </div>

                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
 
                            <!-- Cutting & Stitching Products Tab -->
                            <div x-show="OpenTab == 6" class="tab-pane">
                                <div class="row">
                                    {% for product in products if product.category ==
                                    'Cutting & Stitching' %}
                                    <div class="products">
                                        <div class="badge badge-primary badge-pill" data-field="en">{{ product.title }}
                                        </div>
                                        <div class="badge badge-primary badge-pill" data-field="ar">{{
                                            product.title_arabic }}
                                        </div>
                                        {% if product.variations["qty"]|int > 0 %}
                                        <!-- Available Badge when qty is greater than 0 -->
                                        <div class="badge badge-primary badge-pill available"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Available</div>
                                        {% else %}
                                        <!-- Sold Out Badge when qty is 0 or less -->
                                        <div class="badge badge-primary badge-pill soldout"
                                            style="background-color: #30a6f7;border-color: #30a6f7;" data-field="en">
                                            Sold Out</div>
                                        {% endif %}
                                        <div class="card product-card">
                                            <a href="/product-detail?id={{product.name}}">
                                                <div class="card-head">
                                                    <img class="card-image" src="{{ product.featured_image }}"
                                                        alt="Product Image">
                                                </div>
                                                <div class="card-body">

                                                    <div class="variation">
                                                        <div class="card-title" data-field="en">{{
                                                            product.variations["title"]
                                                            }}</div>
                                                        <div class="card-title" data-field="ar">{{
                                                            product.variations["title_arabic"]
                                                            }}
                                                        </div>

                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="en">{{
                                                            product.variations["desc"]
                                                            }}</div>
                                                        <div class="card-desc text-ellipsis text-ellipsis-2"
                                                            data-field="ar">{{
                                                            product.variations["description_in_arabic"]
                                                            }}</div>
                                                        <div class="card-subtitle"><del>{{
                                                                product.variations["discount"]}}</del>
                                                        </div>
                                                        <div class="card-title card-price">$
                                                            {{
                                                            product.variations["price"]
                                                            }}</div>
                                                    </div>

                                                    <div class="card-rating remaining">
                                                        <i class="bx bxs-star"></i>
                                                        <span>{{product.variations["rating"]}}</span>
                                                        ({{product.variations["qty"]}}) Remaining 
                                                    </div>
                                                </div>
                                            </a>
                                            <div class="card-foot">
                                                <button class="btn btn-light btn-icon btn-pill btn-cart"><i
                                                        class="bx bx-cart icon-pre buy_now_button"
                                                        id="buy_now_button_e"></i>
                                                </button>
                                                <!-- <button class="btn btn-light btn-icon btn-circle bx bx-heart btn-heart" style="display:none"></button> -->
                                            </div>

                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
{% endblock %}
{% block scripts %}
<script>
    window.onload = function () {
        // Set the title and header for the Contact page
        const pageTitles = {
            ar: 'المنتج - قطة',
            en: 'Product - Qetah'
        };

        const pageHeaders = {
            ar: 'المنتج - قطة',
            en: 'Product - Qetah'
        };

        setPageTitle(pageTitles, pageHeaders);
    };
</script>
<script>
    function applyCategoryFilter(category) {
        const filters = {
            category: category // Set the category filter based on the user's selection
        };

        // Construct the query string and update the URL
        const queryString = new URLSearchParams(filters).toString();
        window.location.href = `/product?${queryString}`;
    }
    function applyFilters(event) {
        if (event) event.preventDefault(); // Prevent the form from submitting normally

        const filters = {
            q: document.getElementById('search-query') ? document.getElementById('search-query').value : '',  // Check if element exists
            category: Array.from(document.querySelectorAll('input[name="category"]:checked')).map(el => el.value),
            min_price: document.getElementById('price-range-min').value,
            max_price: document.getElementById('price-range-max').value,
            rating: document.querySelector('input[name="rating"]:checked') ? document.querySelector('input[name="rating"]:checked').value : '',
            discount: Array.from(document.querySelectorAll('input[name="discount"]:checked')).map(el => el.value)
        };

        const queryString = new URLSearchParams(filters).toString();
        window.location.href = `/product?${queryString}`;

    }

    function getVals() {
        // Get slider values
        let parent = this.parentNode;
        let slides = parent.getElementsByTagName("input");
        let slide1 = parseFloat(slides[0].value);
        let slide2 = parseFloat(slides[1].value);

        // Ensure slide1 is always less than slide2
        if (slide1 > slide2) {
            [slide1, slide2] = [slide2, slide1]; // Swap the values
        }

        let displayElement = parent.getElementsByClassName("rangeValues")[0];
        displayElement.innerHTML = "$" + slide1 + " - $" + slide2;
    }

    function initializeSliders(className) {
        let sliderSections = document.getElementsByClassName(className);
        for (let x = 0; x < sliderSections.length; x++) {
            let sliders = sliderSections[x].getElementsByTagName("input");
            for (let y = 0; y < sliders.length; y++) {
                if (sliders[y].type === "range") {
                    sliders[y].addEventListener('input', getVals);
                    // Manually trigger event first time to display values
                    sliders[y].dispatchEvent(new Event('input'));
                }
            }
        }
    }

    // Check if the product already exists in the list
    function addOrUpdateProduct(productList, newProduct) {
        let cart_list = JSON.parse(localStorage.getItem('cart')) || []
        if (cart_list) {
            for (let product of cart_list) {
                if (product.unique_name === newProduct.unique_name) {
                    // If exists, add or update the qty key
                    if (product.qty) {
                        product.qty += 1;
                    } else {
                        product.qty = 1;
                    }

                    localStorage.setItem('cart', JSON.stringify(cart_list));
                    return true; // Indicates that the product was updated
                }
            }
        }
        // If the product does not exist, add it to the list
        newProduct.qty = 1;
        cart_list.push(newProduct)
        localStorage.setItem('cart', JSON.stringify(cart_list));
        return false; // Indicates that a new product was added
    }
    function onrefreshupdateOffcanvas(offcanvasBody, badge) {

        // Clear the current items
        offcanvasBody.innerHTML = '';

        // Fetch the cart from localStorage
        // localStorage.setItem('cart', JSON.stringify([]))
        let cartlist = JSON.parse(localStorage.getItem('cart')) || [];  // Default to an empty array if no cart is found


        // Add each item in the wishlist to the offcanvas
        cartlist.forEach((item, index) => {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'items d-flex';
            itemDiv.setAttribute('data-index', index);

            let itemprice = parseFloat(item.price.replace(/[^0-9.]/g, ''));

            let price = itemprice * item.qty
            itemDiv.innerHTML = `
                <div class="check-item">
                    <label class="check check-secondary">
                        <input type="checkbox" class="item-checkbox" data-index="`+ index + `" />
                    </label>
                </div>
                <img src="${item.image}" alt="${item.title}" class="offcanvas-image" data-elm ="img" />
                <div class="text">
                    <p class="offcanvas-title text-ellipsis" data-elm ="title">${item.title}</p>
                    <div class="text-ellipsis text-ellipsis-2" style="font-size: 13px;margin-top: -10px;color: #626161;" data-elm ="desc">${item.desc}</div>
                    <div class="quantity-counter">
                        <p class="price update-price" data-price-per-item="${item.price}" data-index="` + index + `" >$ ${(price).toFixed(2)}</p>
                        <div class="counter">
                            <button class="btn btn-light btn-circle btn-circle-sm bx bx-minus counter-decrement" data-index="`+ index + `" id="selectAll2"></button>
                            <input class="counter-value value" type="number" value="${item.qty}" min="0" data-index="` + index + `" />
                            <button class="btn btn-light btn-circle btn-circle-sm bx bx-plus counter-increment" data-index="`+ index + `" id="selectAll2"></button>
                        </div>
                    </div>
                </div>
            `;
            offcanvasBody.appendChild(itemDiv);


        });
        badge.textContent = cartlist.length;
    }


    document.addEventListener('DOMContentLoaded', () => {
        const offcanvas = document.getElementById('offcanvas-cart');
        const offcanvasBody = offcanvas.querySelector('.offcanvas-body-cart');
        const badge = document.querySelector('.cart-badge');
        const deleteSelectedBtn = document.getElementById('del-cart');
        setTimeout(function () {
            onrefreshupdateOffcanvas(offcanvasBody, badge);
        }, 1000);
        // Initialize sliders after the DOM content is fully loaded
        initializeSliders('range-slider');
        initializeSliders('model-range-slider');



        let wishlist = JSON.parse(localStorage.getItem('cart')) || [];

        function updateOffcanvas(wishlist = false) {
            // Clear the current items

            if (!wishlist) {
                wishlist = JSON.parse(localStorage.getItem('cart')) || [];
            }
            offcanvasBody.innerHTML = '';
            console.log(wishlist);

            // Add each item in the wishlist to the offcanvas
            wishlist.forEach((item, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'items d-flex';
                itemDiv.setAttribute('data-index', index);

                let itemprice = parseFloat(item.price.replace(/[^0-9.]/g, ''));

                let price = itemprice * item.qty
                itemDiv.innerHTML = `
                    <div class="check-item">
                        <label class="check check-secondary">
                            <input type="checkbox" class="item-checkbox" data-index="`+ index + `" />
                        </label>
                    </div>
                    <img src="${item.image}" alt="${item.title}" class="offcanvas-image"  data-elm ="img"/>
                    <div class="text">
                        <p class="offcanvas-title text-ellipsis"  data-elm ="title" >${item.title}</p>
                        <div class="text-ellipsis text-ellipsis-2" style="font-size: 13px;margin-top: -10px;color: #626161;"  data-elm ="desc">${item.desc}</div>
                        <div class="quantity-counter">
                            <p class="price update-price" data-price-per-item="${item.price}" data-index="` + index + `" >$ ${(price).toFixed(2)}</p>
                            <div class="counter">
                                <button class="btn btn-light btn-circle btn-circle-sm bx bx-minus counter-decrement" data-index="`+ index + `" id="selectAll2"></button>
                                <input class="counter-value value" type="number" value="${item.qty}" min="0" data-index="` + index + `" />
                                <button class="btn btn-light btn-circle btn-circle-sm bx bx-plus counter-increment" data-index="`+ index + `" id="selectAll2" ></button>
                            </div>
                        </div>
                    </div>
                `;
                offcanvasBody.appendChild(itemDiv);
            });

            // Update badge number
            badge.textContent = wishlist.length;

            // Attach event listeners to the quantity buttons
            document.querySelectorAll('.counter-increment').forEach(button => {
                button.addEventListener('click', () => {
                    const index = button.getAttribute('data-index');
                    updateQuantity(index, 1);
                });
            });

            document.querySelectorAll('.counter-decrement').forEach(button => {
                button.addEventListener('click', () => {
                    const index = button.getAttribute('data-index');
                    updateQuantity(index, -1);
                });
            });
        }

        function updateQuantity(index, delta) {
            const item = wishlist[index];
            if (item) {
                item.qty = Math.max(0, (item.qty || 0) + delta); // Prevent negative quantity
                // Update the quantity input field and the offcanvas
                updateOffcanvas();
            }
        }

        function addTowishlist(product) {
            // Add or update the product in the wishlist array
            const updated = addOrUpdateProduct(wishlist, product);
            // Update the offcanvas display
            updateOffcanvas();
        }

        document.querySelectorAll('.btn-cart').forEach(button => {
            button.addEventListener('click', (e) => {
                // Get the selected language from localStorage
                const selectedLanguage = localStorage.getItem('selectedLanguage') || 'en';

                // Find the product card
                const productCard = e.target.closest('.product-card');
                if (!productCard) return;

                // Determine which data-field to fetch based on the selected language
                const titleSelector = selectedLanguage === 'ar' ? '[data-field="ar"]' : '[data-field="en"]';
                const descSelector = selectedLanguage === 'ar' ? '[data-field="ar"]' : '[data-field="en"]';

                // Get product details from the card based on the selected language
                const product = {
                    title: productCard.querySelector('.card-title' + titleSelector).innerText,
                    image: productCard.querySelector('.card-image').src,
                    desc: productCard.querySelector('.card-desc' + descSelector).innerText,
                    price: productCard.querySelector('.card-price').innerText,
                    unique_name: productCard.querySelector('.card-unique-name').innerText, // Assuming price remains the same in both languages
                };
                console.log(product);

                // Add product to wishlist
                addTowishlist(product);
            });
        });

        deleteSelectedBtn.addEventListener('click', () => {

            const checkboxes = offcanvasBody.querySelectorAll('.item-checkbox');

            // Iterate backward to safely remove items
            for (let i = checkboxes.length - 1; i >= 0; i--) {
                const checkbox = checkboxes[i];
                if (checkbox.checked) {
                    const index = parseInt(checkbox.getAttribute('data-index'), 10);
                    wishlist.splice(index, 1);
                    checkbox.closest('.items').remove();
                }
            }
            updateOffcanvas();
        });

        function updateSubtotal() {
            const checkboxes = document.querySelectorAll('.item-checkbox'); // Select all checkboxes
            let subtotal = 0; // Initialize subtotal

            checkboxes.forEach(checkbox => {
                if (checkbox.checked) { // Check if the checkbox is checked
                    const index = checkbox.getAttribute('data-index'); // Get the data-index
                    const priceElement = document.querySelector(`.update-price[data-index="` + index + `"]`); // Select the corresponding price element

                    if (priceElement) {
                        const itemPrice = parseFloat(priceElement.textContent.replace('$', '').trim());
                        subtotal += itemPrice; // Add the item's total price to the subtotal
                    }
                }
            });

            // Update the subtotal display
            const subtotalElement = document.getElementById('subTotal');
            subtotalElement.textContent = `$ ${(subtotal).toFixed(2)}`; // Format and display the subtotal
        }

        document.addEventListener('click', (event) => {
            const target = event.target;

            if (target.classList.contains('select-all-checkbox')) {
                const checkboxes = document.querySelectorAll('.item-checkbox'); // Select all item checkboxes

                // Check or uncheck all based on the "Select All" checkbox state
                checkboxes.forEach(checkbox => {
                    checkbox.checked = target.checked; // Set the checked state based on "Select All"
                });

                // Update the subtotal after changing the checkboxes
                updateSubtotal();
            }

            // Check if the clicked element is an increment or decrement button
            if (target.classList.contains('counter-increment') || target.classList.contains('counter-decrement')) {
                const index = target.getAttribute('data-index'); // Get the data-index of the clicked button
                const inputField = document.querySelector(`.counter-value[data-index="` + index + `"]`); // Select the corresponding input field

                // Get the current quantity
                let currentValue = parseInt(inputField.value);
                let add = false
                // Determine if we are incrementing or decrementing
                if (target.classList.contains('counter-increment')) {
                    currentValue++; // Increment the value
                    add = true
                } else if (target.classList.contains('counter-decrement')) {
                    if (currentValue > 0) {
                        add = false
                        currentValue--; // Decrement the value, but don't go below 0
                    }
                }

                inputField.value = currentValue; // Update the input field with the new quantity

                // Update the displayed price
                const priceElement = document.querySelector(`.update-price[data-index="` + index + `"]`);
                const pricePerItem = parseFloat(priceElement.getAttribute('data-price-per-item').replace('$', '').trim());
                const totalPrice = pricePerItem * currentValue;

                // Update the price display
                priceElement.textContent = `$ ${(totalPrice).toFixed(2)}`;

                // Check if the corresponding checkbox is checked
                const checkbox = document.querySelector(`.item-checkbox[data-index="` + index + `"]`);
                if (checkbox && checkbox.checked) {
                    updateSubtotal(); // Update the subtotal if the checkbox is checked
                }

                // Fetch the title, image, and description using data-elm attributes
                // Update the cart in local storage
                updateCartInLocalStorage(index, currentValue, add);
            }

            // Check if a checkbox was clicked
            if (target.classList.contains('item-checkbox')) {
                updateSubtotal(); // Call the function to update the subtotal when a checkbox is checked/unchecked
            }
        });

        // Function to update the subtotal of checked items


        // Function to update the cart in local storage based on item properties
        // Function to update the cart in local storage based on item quantity
        function updateCartInLocalStorage(index, quantity, add) {
            // Retrieve the cart from local storage or initialize an empty object
            let cart = JSON.parse(localStorage.getItem('cart')) || {};
            let deleted = []
            cart.forEach((item, index) => {
                cart[index]["index"] = index;
                const checkbox = document.querySelector('.item-checkbox[data-index="' + index + '"]');
                cart[index]["checked"] = checkbox.checked;
            });
            // If 'add' is true, increase the quantity
            if (add === true) {
                if (cart[index]) {
                    cart[index]["qty"] = quantity; // Increment the quantity if item already exists
                } else {
                    // If the item doesn't exist, initialize it with the given quantity
                    cart[index] = { qty: quantity };
                }
            } else {
                // If 'add' is false, set the quantity directly (update the quantity)
                if (cart[index]) {
                    cart[index]["qty"] = quantity; // Update the quantity for existing item
                } else {
                    // If the item doesn't exist, add it to the cart with the given quantity
                    cart[index] = { qty: quantity };
                }
            }


            // Clean up any undefined or null entries in the cart

            cart = cart.filter(item => item.qty > 0);
            localStorage.setItem('cart', JSON.stringify(cart));
            // Save the updated cart back to local storage
            updateOffcanvas2(cart);

        }
        function updateOffcanvas2(cart) {
            // Clear the current items

            let wishlist = cart
            offcanvasBody.innerHTML = '';
            console.log(wishlist);

            // Add each item in the wishlist to the offcanvas
            wishlist.forEach((item, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'items d-flex';
                itemDiv.setAttribute('data-index', index);

                let itemprice = parseFloat(item.price.replace(/[^0-9.]/g, ''));

                let price = itemprice * item.qty
                itemDiv.innerHTML = `
                    <div class="check-item">
                        <label class="check check-secondary">
                            <input type="checkbox" class="item-checkbox" ${item.checked ? 'checked' : ''} data-index="` + index + `" />
                        </label>
                    </div>
                    <img src="${item.image}" alt="${item.title}" class="offcanvas-image"  data-elm ="img"/>
                    <div class="text">
                        <p class="offcanvas-title text-ellipsis"  data-elm ="title" >${item.title}</p>
                        <div class="text-ellipsis text-ellipsis-2" style="font-size: 13px;margin-top: -10px;color: #626161;"  data-elm ="desc">${item.desc}</div>
                        <div class="quantity-counter">
                            <p class="price update-price" data-price-per-item="${item.price}" data-index="` + index + `" >$ ${(price).toFixed(2)}</p>
                            <div class="counter">
                                <button class="btn btn-light btn-circle btn-circle-sm bx bx-minus counter-decrement" data-index="`+ index + `" id="selectAll2"></button>
                                <input class="counter-value value" type="number" value="${item.qty}" min="0" data-index="` + index + `" />
                                <button class="btn btn-light btn-circle btn-circle-sm bx bx-plus counter-increment" data-index="`+ index + `" id="selectAll2" ></button>
                            </div>
                        </div>
                    </div>
                `;
                offcanvasBody.appendChild(itemDiv);
            });

            // Update badge number
            badge.textContent = wishlist.length;
        }
    });

</script>
<script>
    // arabic id
    function updatePageContent(translations) {
        //product
        document.getElementById('filter_title').textContent = translations['filter_title'];
        document.getElementById('category_title').textContent = translations['category_title'];
        document.getElementById('price_range_title').textContent = translations['price_range_title'];
        document.getElementById('by_rating_title').textContent = translations['by_rating_title'];

        document.getElementById('filter_title_m').textContent = translations['filter_title_m'];
        document.getElementById('category_title_m').textContent = translations['category_title_m'];
        document.getElementById('price_range_title_m').textContent = translations['price_range_title_m'];
        document.getElementById('by_rating_title_m').textContent = translations['by_rating_title_m'];
        document.getElementById('discounts_title_m').textContent = translations['discounts_title_m'];
        document.getElementById('apply_button').textContent = translations['apply_button'];
        document.getElementById('apply_button_m').textContent = translations['apply_button_m'];
        document.getElementById('cancel_button_m').textContent = translations['cancel_button'];


        document.getElementById('tab_all').textContent = translations['tab_all'];
        document.getElementById('discounts_title_h').textContent = translations['discounts_title_h'];
        document.getElementById('tab_unstitched').textContent = translations['tab_unstitched'];
        document.getElementById('tab_readymade').textContent = translations['tab_readymade'];
        document.getElementById('tab_accessories').textContent = translations['tab_accessories'];
        document.getElementById('tab_perfumes').textContent = translations['tab_perfumes'];
        document.getElementById('tab_cutting_stitching').textContent = translations['tab_cutting_stitching'];

        // document.getElementById('buy_now_button').textContent = translations['buy_now_button'];

        //if our category is null then 
        const buttons = document.querySelectorAll('.buy_now_button');
        if (buttons && translations['buy_now_button']) {
            buttons.forEach(button => {
                button.innerText = translations['buy_now_button'];
            });
        }
        const available = document.querySelectorAll('.available');
        if (buttons && translations['available']) {
            buttons.forEach(button => {
                button.innerText = translations['available'];
            });
        }
        const soldout = document.querySelectorAll('.soldout');
        if (buttons && translations['soldout']) {
            buttons.forEach(button => {
                button.innerText = translations['soldout'];
            });
        }
        const remaining = document.querySelectorAll('.remaining');
        if (buttons && translations['remaining']) {
            buttons.forEach(button => {
                button.innerText = translations['remaining'];
            });
        }


        document.getElementById('search-query').setAttribute('placeholder', translations['search_placeholder']);
        document.getElementById('category_mens_m').textContent = translations['category_mens_m'];
        document.getElementById('category_womens_m').textContent = translations['category_womens_m'];
        document.getElementById('category_services_m').textContent = translations['category_services_m'];
        document.getElementById('discount_35_m').textContent = translations['discount_35_m'];
        document.getElementById('discount_50_m').textContent = translations['discount_50_m'];
        document.getElementById('discount_75_m').textContent = translations['discount_75_m'];

        document.getElementById('category_mens_l').textContent = translations['category_mens_l'];
        document.getElementById('category_womens_l').textContent = translations['category_womens_l'];
        document.getElementById('category_services_l').textContent = translations['category_services_l'];
        document.getElementById('discount_35_l').textContent = translations['discount_35_l'];
        document.getElementById('discount_50_l').textContent = translations['discount_50_l'];
        document.getElementById('discount_75_l').textContent = translations['discount_75_l'];

        // document.getElementById('category_mens').textContent = translations['category_mens'];
        // document.getElementById('category_womens').textContent = translations['category_womens'];
        // document.getElementById('category_womens_h').textContent = translations['category_womens_h'];
        // document.getElementById('category_services_h').textContent = translations['category_services_h'];
        // document.getElementById('category_services').textContent = translations['category_services'];
        document.getElementById('apply_button').textContent = translations['apply_button'];
    }

</script>
{% endblock %}